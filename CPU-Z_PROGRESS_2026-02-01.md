# CPU-Z Emulation Progress Report
## –î–∞—Ç–∞: 2026-02-01 (–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)

## üéØ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

### –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
- **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ**: 1,575 (—Ä–∞–Ω—å—à–µ –±—ã–ª–æ 3,448,734)
- **–ü—Ä–æ–±–ª–µ–º–∞**: CPU-Z –≤—ã–∑—ã–≤–∞–µ—Ç ExitProcess(255) –Ω–∞ —Ä–∞–Ω–Ω–µ–π —Å—Ç–∞–¥–∏–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ü—Ä–∏—á–∏–Ω–∞**: CPU-Z –ø—Ä–æ–≤–µ—Ä—è–µ—Ç GUI-–æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –≤—ã—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç –µ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
1. **PE Loading** - –ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU-Z (634 –∏–º–ø–æ—Ä—Ç–∞)
2. **Stub System** - 474 –∑–∞–≥–ª—É—à–∫–∏ —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º –∫–æ–¥–æ–º
3. **Custom —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** - 28 —Ñ—É–Ω–∫—Ü–∏–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É—é:
   - File I/O: CreateFileA/W, ReadFile, WriteFile, CloseHandle
   - Memory: GetProcessHeap, HeapAlloc, HeapFree, VirtualAlloc
   - Timing: GetTickCount, QueryPerformanceCounter, QueryPerformanceFrequency
   - Debugging: IsDebuggerPresent, GetConsoleCP, GetConsoleMode, GetACP, GetOEMCP
   - Module: GetModuleFileNameA/W, GetModuleHandleA/W, LoadLibraryA/W, GetProcAddress
   - Security: EncodePointer, DecodePointer
   - Window Station: GetProcessWindowStation, GetUserObjectInformationA/W
   - Process: ExitProcess, CorExitProcess

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤ –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º
```
1. GetSystemTimeAsFileTime()
2. GetCurrentProcessId()
3. GetCurrentThreadId()
4. GetTickCount()
5. QueryPerformanceCounter()
6. GetStartupInfoW()
7. HeapCreate()
8. GetModuleFileNameA() -> 'C:\sandbox\CPU-Z\cpuz.exe'
9. EncodePointer()
10. LoadLibraryA('USER32.DLL')
11. GetProcAddress('MessageBoxA')
12. GetProcAddress('GetActiveWindow')
13. GetProcAddress('GetLastActivePopup')
14. GetProcAddress('GetUserObjectInformationA')
15. GetProcAddress('GetProcessWindowStation')
16. GetProcessWindowStation() -> 0x100
17. GetUserObjectInformationA() -> NO GUI (WSF_VISIBLE=0)
18. MessageBoxA() -> SUCCESS
19. GetModuleHandleW('mscoree.dll')
20. GetProcAddress('CorExitProcess') -> NULL (blocked)
21. ExitProcess(255) ‚ùå
```

## üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´

### –ü–æ—á–µ–º—É CPU-Z –≤—ã—Ö–æ–¥–∏—Ç —Å –∫–æ–¥–æ–º 255?

CPU-Z –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

1. **GUI Environment Check**:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç USER32.DLL
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ MessageBoxA, GetActiveWindow, GetLastActivePopup
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Window Station —á–µ—Ä–µ–∑ GetProcessWindowStation
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–∞–≥–∏ —á–µ—Ä–µ–∑ GetUserObjectInformationA

2. **.NET Runtime Check**:
   - –ü—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å mscoree.dll
   - –ò—â–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é CorExitProcess
   - –ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ—ë –¥–ª—è –≤—ã—Ö–æ–¥–∞

3. **Exit Decision**:
   - –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ —Å GUI –∏–ª–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
   - –í—ã–∑—ã–≤–∞–µ—Ç ExitProcess(255) - –∫–æ–¥ –æ—à–∏–±–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞ —Å GetCommandLineW

**GetCommandLineW –ù–ï –í–´–ó–´–í–ê–ï–¢–°–Ø!**

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ CPU-Z –≤—ã—Ö–æ–¥–∏—Ç –î–û —Ç–æ–≥–æ, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É. –ü–∞—Ä–∞–º–µ—Ç—Ä `-txt=report` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## üöß –í–û–ó–ú–û–ñ–ù–´–ï –†–ï–®–ï–ù–ò–Ø

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–±–º–∞–Ω—É—Ç—å GUI-–ø—Ä–æ–≤–µ—Ä–∫–∏ ‚ùå (–Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ)
- –í–æ–∑–≤—Ä–∞—â–∞—Ç—å WSF_VISIBLE=1 (–µ—Å—Ç—å GUI)
- –í–æ–∑–≤—Ä–∞—â–∞—Ç—å WSF_VISIBLE=0 (–Ω–µ—Ç GUI)
- –û–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ ExitProcess(255)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å CorExitProcess ‚ùå (–Ω–µ –ø–æ–º–æ–≥–ª–æ)
- GetProcAddress('CorExitProcess') –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç NULL
- CPU-Z –≤—Å—ë —Ä–∞–≤–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç ExitProcess(255)

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å ExitProcess(255) ‚ùå (–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª)
- –ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —ç–º—É–ª—è—Ü–∏—é –ø—Ä–∏ ExitProcess(255)
- –ü—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º—É —Ü–∏–∫–ª—É –≤—ã–∑–æ–≤–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 4: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ GUI-—Ñ—É–Ω–∫—Ü–∏–π ‚ö†Ô∏è (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–±–æ—Ç—ã)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GetActiveWindow, GetLastActivePopup
- –°–æ–∑–¥–∞—Ç—å —Ñ–µ–π–∫–æ–≤–æ–µ –æ–∫–Ω–æ
- –í–µ—Ä–Ω—É—Ç—å handle –æ–∫–Ω–∞

### –í–∞—Ä–∏–∞–Ω—Ç 5: –ü–∞—Ç—á–∏—Ç—å CPU-Z –±–∏–Ω–∞—Ä–Ω–∏–∫ ‚ö†Ô∏è (—Ö–∞–∫)
- –ù–∞–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É GUI –≤ –∫–æ–¥–µ
- –ü—Ä–æ–ø–∞—Ç—á–∏—Ç—å JMP/JNZ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- –ó–∞—Å—Ç–∞–≤–∏—Ç—å CPU-Z –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É

### –í–∞—Ä–∏–∞–Ω—Ç 6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Frida –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ ‚úÖ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- –ó–∞–ø—É—Å—Ç–∏—Ç—å CPU-Z —á–µ—Ä–µ–∑ Frida
- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- –û—Å—Ç–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

### –í–∞—Ä–∏–∞–Ω—Ç 7: –ó–∞–ø—É—Å—Ç–∏—Ç—å CPU-Z –≤ headless —Ä–µ–∂–∏–º–µ ‚úÖ (–Ω—É–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å)
- –í–æ–∑–º–æ–∂–Ω–æ, –µ—Å—Ç—å –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
- –ò–ª–∏ –¥—Ä—É–≥–∞—è –≤–µ—Ä—Å–∏—è CPU-Z –±–µ–∑ GUI-–ø—Ä–æ–≤–µ—Ä–æ–∫
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cpuz_x64.sys –¥—Ä–∞–π–≤–µ—Ä –Ω–∞–ø—Ä—è–º—É—é

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ | 1,575 |
| –ó–∞–≥–ª—É—à–µ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 474 (28 custom + 446 generated) |
| –ò–º–ø–æ—Ä—Ç–æ–≤ –ø—Ä–æ–ø–∞—Ç—á–µ–Ω–æ | 634 |
| –ü–∞–º—è—Ç—å –¥–ª—è –∑–∞–≥–ª—É—à–µ–∫ | 1GB |
| Custom —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π | 28 (5.9%) |

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (–¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —ç–º—É–ª—è—Ü–∏–∏)
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ GetActiveWindow, GetLastActivePopup
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ñ–µ–π–∫–æ–≤–æ–µ –æ–∫–Ω–æ (handle)
3. üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–µ—Ä–Ω—É—Ç—å handle –æ–∫–Ω–∞ –≤–º–µ—Å—Ç–æ NULL
4. üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏–∑–º–µ–Ω–∏—Ç—Å—è –ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ CPU-Z

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ (–µ—Å–ª–∏ GUI-–ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ –ø–æ–º–æ–≥—É—Ç)
1. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ CPU-Z
2. –ù–∞–π—Ç–∏ headless —Ä–µ–∂–∏–º –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
3. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä cpuz_x64.sys –Ω–∞–ø—Ä—è–º—É—é
4. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–∞—Ç—á–∏–Ω–≥ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ (–¥–ª—è production)
1. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Frida –¥–ª—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é GUI-—ç–º—É–ª—è—Ü–∏—é
3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É COM/OLE –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
4. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π registry emulator

## üí° –í–´–í–û–î–´

**–î–≤—É—Ö—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!**

‚úÖ **–°–ª–æ–π 1 (MiniOS)** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞  
‚úÖ **–°–ª–æ–π 2 (WinAPI Stubs)** - –∑–∞–≥–ª—É—à–∫–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è  
‚ùå **–ü—Ä–æ–±–ª–µ–º–∞** - CPU-Z —Ç—Ä–µ–±—É–µ—Ç GUI-–æ–∫—Ä—É–∂–µ–Ω–∏–µ

**CPU-Z —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç:**
- PE –∑–∞–≥—Ä—É–∑–∫—É
- CRT –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
- –ü–µ—Ä–≤—ã–µ 1,575 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ API –≤—ã–∑–æ–≤–æ–≤

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GetActiveWindow –∏ GetLastActivePopup, —á—Ç–æ–±—ã CPU-Z –¥—É–º–∞–ª, —á—Ç–æ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ.

---

**–°—Ç–∞—Ç—É—Å:** üü° –ü—Ä–æ–≥—Ä–µ—Å—Å –µ—Å—Ç—å, –Ω–æ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ö–æ–º–º–∏—Ç:** Added 28 custom WinAPI implementations, CPU-Z reaches 1,575 instructions before ExitProcess(255)
