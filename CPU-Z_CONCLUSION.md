# CPU-Z: –í—ã–≤–æ–¥—ã –∏ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

## –¢–µ–∫—É—â–∞—è –°–∏—Ç—É–∞—Ü–∏—è

CPU-Z —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç **2+ –º–∏–ª–ª–∏–æ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π** –≤ —ç–º—É–ª—è—Ç–æ—Ä–µ, –Ω–æ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á—ë—Ç–∞.

### –ß—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç ‚úì
- PE –∑–∞–≥—Ä—É–∑–∫–∞ (634 –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–æ–ø–∞—Ç—á–µ–Ω–æ)
- CRT –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é (heap, TLS, FLS)
- –§–∞–π–ª–æ–≤—ã–π I/O (—Ä–µ–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã)
- –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (`-txt=report`)
- –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`cpuz.ini`)
- 100+ WinAPI –∑–∞–≥–ª—É—à–µ–∫
- CPUID —ç–º—É–ª—è—Ü–∏—è (–¥–æ–±–∞–≤–ª–µ–Ω–∞)

### –ü—Ä–æ–±–ª–µ–º–∞ üö´
CPU-Z –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –Ω–∞ unmapped memory read –ø–æ –∞–¥—Ä–µ—Å—É `0x7dc093969848` (–æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π –∞–¥—Ä–µ—Å).

## –ê–Ω–∞–ª–∏–∑ –ü—Ä–æ–±–ª–µ–º—ã

### –ü–æ—á–µ–º—É –ü–æ–ª–Ω–∞—è –≠–º—É–ª—è—Ü–∏—è –°–ª–æ–∂–Ω–∞

1. **Unicorn –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –≠–º—É–ª—è—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ Windows API –Ω–∞–ø—Ä—è–º—É—é
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è**: –ù—É–∂–µ–Ω –º–∞—Ä—à–∞–ª–∏–Ω–≥ –º–µ–∂–¥—É —ç–º—É–ª—è—Ç–æ—Ä–æ–º –∏ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
3. **–î—Ä–∞–π–≤–µ—Ä—ã**: CPU-Z –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∂–µ–ª–µ–∑—É (MSR, PCI, etc.)
4. **GUI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –î–∞–∂–µ –≤ CLI —Ä–µ–∂–∏–º–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ü–æ–¥—Ö–æ–¥—ã

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ü–∏—è (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Frida** –∏–ª–∏ **PIN** –≤–º–µ—Å—Ç–æ Unicorn:

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –†–µ–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ (–Ω–µ —ç–º—É–ª—è—Ü–∏—è)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ –≤—Å–µ—Ö Windows API
- –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–∑–æ–≤–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏

**–ü—Ä–∏–º–µ—Ä —Å Frida**:
```python
import frida
import sys

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ CreateFileW
script_code = """
Interceptor.attach(Module.findExportByName("kernel32.dll", "CreateFileW"), {
    onEnter: function(args) {
        console.log("[CreateFileW] " + args[0].readUtf16String());
    },
    onLeave: function(retval) {
        console.log("  -> " + retval);
    }
});
"""

# –ó–∞–ø—É—Å–∫ CPU-Z —Å –ø–µ—Ä–µ—Ö–≤–∞—Ç–æ–º
process = frida.spawn(["cpuz.exe", "-txt=report"])
session = frida.attach(process)
script = session.create_script(script_code)
script.load()
frida.resume(process)
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: API Hooking
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Detours** (Microsoft) –∏–ª–∏ **EasyHook**:

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ù–∞—Ç–∏–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- –ü–µ—Ä–µ—Ö–≤–∞—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ DLL
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–∞—Ç—á–∏–Ω–≥ –ë–∏–Ω–∞—Ä–Ω–∏–∫–∞
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `cpuz.exe`:

**–ß—Ç–æ –ø–∞—Ç—á–∏—Ç—å**:
- –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞
- –ó–∞–º–µ–Ω–∏—Ç—å hardware detection –Ω–∞ —Ñ–µ–π–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- –§–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å CLI —Ä–µ–∂–∏–º –±–µ–∑ GUI

#### –í–∞—Ä–∏–∞–Ω—Ç 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –î—Ä—É–≥—É—é –£—Ç–∏–ª–∏—Ç—É
–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- **HWiNFO** (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—â–µ)
- **AIDA64** (–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π, –Ω–æ –µ—Å—Ç—å trial)
- **CPU-X** (open source –∞–Ω–∞–ª–æ–≥)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ü—Ä–æ–µ–∫—Ç–∞

### –î–ª—è –û–±—É—á–µ–Ω–∏—è –ê–Ω—Ç–∏-–¢–∞–º–ø–µ—Ä—É

–¢–µ–∫—É—â–∏–π —ç–º—É–ª—è—Ç–æ—Ä **–æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç** –¥–ª—è:
1. ‚úÖ –ü—Ä–æ—Å—Ç—ã—Ö –∞–Ω—Ç–∏-—Ç–∞–º–ø–µ—Ä–æ–≤ (time checks, RDTSC)
2. ‚úÖ –õ–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
3. ‚úÖ –û–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
4. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞—â–∏—Ç

–¢–µ–∫—É—â–∏–π —ç–º—É–ª—è—Ç–æ—Ä **–ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç** –¥–ª—è:
1. ‚ùå –°–ª–æ–∂–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ (CPU-Z, GPU-Z)
2. ‚ùå –ü—Ä–æ–≥—Ä–∞–º–º —Å GUI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
3. ‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä–µ–∞–ª—å–Ω–æ–µ –∂–µ–ª–µ–∑–æ

### –ß—Ç–æ –î–µ–ª–∞—Ç—å —Å CPU-Z

**–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ** (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏):
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Frida –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–∑–æ–≤–æ–≤
- –°–æ–∑–¥–∞—Ç—å mock –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–æ–≤
- –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –Ω–∞ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ

**–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ** (–¥–ª—è production):
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Frida/PIN –≤ –ø—Ä–æ–µ–∫—Ç
- –°–æ–∑–¥–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º (—ç–º—É–ª—è—Ü–∏—è + —Ä–µ–∞–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã)
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é

## –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

### –ü–ª–∞–Ω A: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Frida
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Frida: `pip install frida frida-tools`
2. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –¥–ª—è CPU-Z
3. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ WinAPI –≤—ã–∑–æ–≤—ã
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–≥–ª—É—à–µ–∫

### –ü–ª–∞–Ω B: –£–ø—Ä–æ—Å—Ç–∏—Ç—å –î–µ–º–æ
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –≤–º–µ—Å—Ç–æ CPU-Z
2. –°–æ–∑–¥–∞—Ç—å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä —Å time-based –∑–∞—â–∏—Ç–æ–π
3. –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞ –Ω—ë–º

### –ü–ª–∞–Ω C: –ü–∞—Ç—á–∏–Ω–≥ CPU-Z
1. –ù–∞–π—Ç–∏ –∏ –ø—Ä–æ–ø–∞—Ç—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥—Ä–∞–π–≤–µ—Ä–∞
2. –ó–∞–º–µ–Ω–∏—Ç—å hardware detection –Ω–∞ NOP
3. –ò–Ω–∂–µ–∫—Ç–∏—Ç—å —Ñ–µ–π–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

## –ö–æ–¥ –¥–ª—è Frida (–ì–æ—Ç–æ–≤—ã–π –ü—Ä–∏–º–µ—Ä)

```python
#!/usr/bin/env python3
"""CPU-Z —Å Frida - —Ä–µ–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ"""

import frida
import sys
import time

# –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞
SCRIPT = """
// –ü–µ—Ä–µ—Ö–≤–∞—Ç CreateFileW
Interceptor.attach(Module.findExportByName("kernel32.dll", "CreateFileW"), {
    onEnter: function(args) {
        this.filename = args[0].readUtf16String();
        console.log("[CreateFileW] " + this.filename);
    },
    onLeave: function(retval) {
        console.log("  -> Handle: " + retval);
    }
});

// –ü–µ—Ä–µ—Ö–≤–∞—Ç WriteFile
Interceptor.attach(Module.findExportByName("kernel32.dll", "WriteFile"), {
    onEnter: function(args) {
        var size = args[2].toInt32();
        console.log("[WriteFile] Size: " + size);
    },
    onLeave: function(retval) {
        console.log("  -> Success: " + retval);
    }
});

// –ü–µ—Ä–µ—Ö–≤–∞—Ç ExitProcess
Interceptor.attach(Module.findExportByName("kernel32.dll", "ExitProcess"), {
    onEnter: function(args) {
        console.log("[ExitProcess] Code: " + args[0]);
    }
});
"""

def main():
    print("[*] –ó–∞–ø—É—Å–∫ CPU-Z —Å Frida...")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º CPU-Z
    pid = frida.spawn(["sandbox/CPU-Z/cpuz.exe", "-txt=report"])
    session = frida.attach(pid)
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç
    script = session.create_script(SCRIPT)
    script.on('message', lambda msg, data: print(msg))
    script.load()
    
    # –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    frida.resume(pid)
    
    print("[*] CPU-Z –∑–∞–ø—É—â–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º –≤—ã–∑–æ–≤—ã...")
    print("[*] –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏")
    
    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        print("\n[*] –û—Å—Ç–∞–Ω–æ–≤–∫–∞...")
    
    session.detach()

if __name__ == "__main__":
    main()
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠–º—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–ª—è —Å–≤–æ–µ–π —Ü–µ–ª–∏ (–∞–Ω–∞–ª–∏–∑ –∞–Ω—Ç–∏-—Ç–∞–º–ø–µ—Ä–æ–≤), –Ω–æ CPU-Z —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–µ–Ω –¥–ª—è –ø–æ–ª–Ω–æ–π —ç–º—É–ª—è—Ü–∏–∏. –†–µ–∫–æ–º–µ–Ω–¥—É—é:

1. **–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
2. **–î–ª—è CPU-Z**: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Frida
3. **–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞**: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–º—É–ª—è—Ç–æ—Ä –¥–ª—è –∞–Ω—Ç–∏-—Ç–∞–º–ø–µ—Ä–æ–≤, –¥–æ–±–∞–≤–∏—Ç—å Frida –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

–¢–µ–∫—É—â–∏–π –∫–æ–¥ —ç–º—É–ª—è—Ç–æ—Ä–∞ - –æ—Ç–ª–∏—á–Ω–∞—è –±–∞–∑–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞—â–∏—Ç!
